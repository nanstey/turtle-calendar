:root {
  --bg-0: #2c261e;
  --bg-1: #4a3e2d;
  --panel: #efe2c8;
  --panel-2: #e3d1b0;
  --ink: #2b2116;
  --muted: #5f503f;
  --accent: #be7d3f;
  --accent-soft: #d49f6f;
  --shell-line: #24354a;
  --shell-month: #7f9736;
  --shell-month-soft: #94aa4a;
  --shell-day: #c4d6aa;
  --shell-day-soft: #dae7c0;
  --glow: #f3e6b3;
  --zodiac-base: #8d4b2d;
  --zodiac-active: #cc8a3f;
}

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  font-family: 'Trebuchet MS', 'Segoe UI', sans-serif;
  color: var(--ink);
  background:
    radial-gradient(circle at 0% 0%, #5c4f3b 0%, transparent 35%),
    radial-gradient(circle at 100% 20%, #4f4534 0%, transparent 28%),
    linear-gradient(160deg, var(--bg-0), var(--bg-1));
}

a {
  color: #1f4f76;
}

.app-shell {
  width: min(1200px, 100% - 2rem);
  margin: 1rem auto 2rem;
  display: grid;
  gap: 1rem;
}

.top-panel,
.shell-card,
.calendar-system-panel,
.zodiac-section,
.content-panel .content-section-card {
  background: linear-gradient(170deg, var(--panel), var(--panel-2));
  border: 1px solid #d0bb95;
  border-radius: 14px;
  box-shadow: 0 10px 28px rgb(0 0 0 / 20%);
}

.top-panel {
  padding: 1rem 1.25rem;
}

h1,
h2,
h3,
p {
  margin: 0;
}

h1 {
  font-size: clamp(1.8rem, 3.2vw, 2.3rem);
}

h2 {
  font-size: 1.28rem;
}

.collapsible-summary {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  cursor: pointer;
  list-style: none;
}

.collapsible-summary:focus-visible {
  outline: 2px solid #9c6e3b;
  outline-offset: 2px;
  border-radius: 6px;
}

.collapsible-summary::-webkit-details-marker {
  display: none;
}

.collapsible-summary::after {
  content: '+';
  margin-left: auto;
  font-size: 1.2rem;
  line-height: 1;
  color: #6d563b;
}

.collapsible-section[open] > .collapsible-summary::after {
  content: '\2212';
}

.collapsible-content {
  margin-top: 0.45rem;
  display: grid;
  gap: 0.55rem;
}

.subtitle {
  margin-top: 0.4rem;
  color: var(--muted);
}

.top-grid {
  margin-top: 0.9rem;
  display: grid;
  gap: 0.9rem;
  grid-template-columns: repeat(3, minmax(0, 1fr));
}

.metric-card {
  background: rgb(255 255 255 / 35%);
  border: 1px solid rgb(131 106 76 / 40%);
  border-radius: 12px;
  padding: 0.85rem;
}

.metric-card h2 {
  font-size: 1.38rem;
  margin-bottom: 0.18rem;
}

.metric-value {
  margin-top: 0.35rem;
  font-size: 1.12rem;
  font-weight: 700;
  line-height: 1.2;
}

.metric-detail {
  margin-top: 0.3rem;
  color: var(--muted);
  font-size: 0.95rem;
  line-height: 1.3;
}

.turtle-date-range {
  margin-top: 0.12rem;
}

.turtle-date-range .metric-detail {
  margin-top: 0.15rem;
}

.date-picker-wrap {
  margin-top: 0.65rem;
  display: grid;
  gap: 0.35rem;
}

.date-picker-label {
  font-size: 0.83rem;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.04em;
  color: #6d563b;
}

.date-picker-row {
  display: grid;
  grid-template-columns: 1fr auto auto;
  gap: 0.42rem;
}

.date-picker-input {
  min-height: 2.2rem;
  padding: 0.44rem 0.6rem;
  border-radius: 9px;
  border: 1px solid #b99765;
  background: linear-gradient(180deg, #fff6e5, #f2e4ca);
  color: #332514;
  font-weight: 600;
}

.date-picker-btn {
  min-height: 2.2rem;
  padding: 0.42rem 0.68rem;
  border-radius: 9px;
  border: 1px solid #9c6e3b;
  background: linear-gradient(180deg, #d79f63, #c5803f);
  color: #28180a;
  font-weight: 700;
  cursor: pointer;
}

.date-picker-btn.secondary {
  background: linear-gradient(180deg, #f4ebd5, #e8d7b2);
  border-color: #b79a70;
  color: #4a3925;
}

.date-picker-btn:hover {
  filter: brightness(1.03);
}

.system-controls-grid {
  display: grid;
  grid-template-columns: repeat(2, minmax(220px, 340px));
  gap: 0.5rem 0.75rem;
  justify-content: start;
}

.system-controls-grid.custom-enabled {
  grid-template-columns: repeat(3, minmax(180px, 280px));
}

.system-select-field {
  display: grid;
  gap: 0.28rem;
  width: 100%;
  max-width: 340px;
}

.system-select-field span {
  font-size: 0.8rem;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.04em;
  color: #6d563b;
}

.system-select-field select {
  min-height: 2.15rem;
  padding: 0.36rem 0.55rem;
  border-radius: 9px;
  border: 1px solid #b99765;
  background: linear-gradient(180deg, #fff6e5, #f2e4ca);
  color: #332514;
  font-weight: 600;
}

.system-date-input {
  min-height: 2.15rem;
  padding: 0.36rem 0.55rem;
  border-radius: 9px;
  border: 1px solid #b99765;
  background: linear-gradient(180deg, #fff6e5, #f2e4ca);
  color: #332514;
  font-weight: 600;
}

.system-active-panel {
  display: grid;
  gap: 0.45rem;
  padding-top: 0.65rem;
  border-top: 1px solid rgb(131 106 76 / 35%);
}

.system-active-panel p {
  margin: 0;
  line-height: 1.35;
}

.system-active-title {
  font-size: 0.82rem;
  font-weight: 700;
  letter-spacing: 0.04em;
  text-transform: uppercase;
  color: #6d563b;
}

.system-pill-row {
  display: flex;
  flex-wrap: wrap;
  gap: 0.4rem;
}

.system-pill {
  padding: 0.22rem 0.55rem;
  border-radius: 999px;
  border: 1px solid #b99765;
  background: rgb(255 255 255 / 45%);
  font-size: 0.9rem;
  font-weight: 600;
}

.system-summary {
  color: var(--muted);
  max-width: 72ch;
}

.system-description-list {
  margin: 0;
  padding-left: 1.1rem;
  display: grid;
  gap: 0.22rem;
  line-height: 1.35;
  max-width: 72ch;
}

.moon-indicator-wrap {
  margin-top: 0.45rem;
  display: grid;
  grid-template-columns: 130px 1fr;
  align-items: center;
  gap: 0.75rem;
}

.moon-indicator-svg {
  width: 130px;
  height: 130px;
  display: block;
}

.moon-track {
  fill: none;
  stroke: #c4b18f;
}

.moon-progress {
  fill: none;
  stroke: url(#moonProgress);
  stroke-linecap: round;
}

.moon-quarter-dot {
  fill: #8b7552;
}

.moon-indicator-dot {
  fill: #f3d79d;
  stroke: #8f5f2f;
  stroke-width: 2;
}

.moon-disk-base {
  fill: #2f343d;
}

.moon-disk-lit {
  fill: url(#moonLit);
}

.moon-disk-ring {
  fill: none;
  stroke: #7f6950;
  stroke-width: 2;
}

.moon-indicator-meta {
  display: grid;
  gap: 0.2rem;
}

.moon-indicator-meta p {
  margin: 0;
  line-height: 1.25;
  font-size: 0.95rem;
}

.visual-panel {
  display: grid;
  grid-template-columns: 1fr;
  gap: 1rem;
}

.shell-card {
  padding: 1rem;
}

.shell-card h2 {
  margin-bottom: 0.4rem;
}

.shell-legend {
  margin-top: 0.45rem;
  color: var(--muted);
  font-size: 0.96rem;
}

.calendar-system-panel {
  padding: 1rem;
}

.calendar-system-section .collapsible-content {
  gap: 0.65rem;
}

.turtle-shell-svg {
  width: 100%;
  height: auto;
  background: radial-gradient(circle at 50% 40%, #f5f0e6, #e5d8bf);
  border-radius: 12px;
  border: 1px solid #ceb690;
}

.day-segment {
  fill: var(--shell-day);
  stroke: var(--shell-line);
  stroke-width: 2.4;
  filter: drop-shadow(0 0 1px rgb(255 255 255 / 40%));
}

.day-segment-active {
  fill: var(--glow);
  filter: url(#glow);
}

.day-label {
  font-size: 27px;
  fill: #1f2e41;
}

.day-label-active {
  fill: #17253a;
  font-weight: 700;
}

.month-segment {
  fill: var(--shell-month);
  stroke: var(--shell-line);
  stroke-width: 6;
  filter: drop-shadow(0 0 1.2px rgb(255 245 214 / 30%));
}

.month-segment-active {
  fill: #b6c96c;
  filter: url(#glow);
}

.month-label {
  fill: #132235;
  font-size: 54px;
  font-weight: 500;
}

.month-label-active {
  fill: #101d2e;
  font-weight: 700;
}

.extra-day-row {
  margin-top: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.6rem;
  flex-wrap: wrap;
}

.extra-day-row.compact {
  margin-top: 0.35rem;
}

.extra-day-badge {
  padding: 0.3rem 0.65rem;
  border-radius: 999px;
  border: 1px solid #a77f4d;
  background: #ead3b1;
  font-weight: 600;
}

.extra-day-badge.active {
  background: #f5e7be;
  box-shadow: 0 0 14px rgb(255 224 126 / 80%);
}

.zodiac-section {
  padding: 1rem;
  display: block;
}

.zodiac-wheel-wrap {
  margin-top: 0.4rem;
  border: 1px solid #cfb88e;
  border-radius: 12px;
  background: radial-gradient(circle at 50% 40%, #f5f0e6, #e5d8bf);
}

.zodiac-wheel-svg {
  display: block;
  width: 100%;
  height: auto;
}

.zodiac-slice {
  fill: var(--zodiac-base);
  stroke: #2f2217;
  stroke-width: 1.3;
}

.zodiac-slice-active {
  fill: var(--zodiac-active);
}

.zodiac-label {
  fill: #fff7e7;
  font-size: 13px;
  font-weight: 700;
}

.zodiac-label-active {
  fill: #1f1208;
}

.zodiac-center-ring {
  fill: none;
  stroke: #72552a;
  stroke-width: 2;
}

.zodiac-center-title {
  font-size: 15px;
  fill: #4d381b;
  font-weight: 700;
}

.zodiac-center-value {
  font-size: 27px;
  fill: #291a09;
  font-weight: 800;
}

.zodiac-pointer {
  fill: #4a3220;
}

.zodiac-rotation-note {
  font-size: 0.95rem;
  color: var(--muted);
  margin-top: 0.15rem;
}

.content-panel {
  display: grid;
  gap: 1rem;
}

.content-panel .content-section-card {
  padding: 1rem;
}

.content-panel .collapsible-content p {
  line-height: 1.45;
}

.table-wrap {
  overflow-x: auto;
}

table {
  width: 100%;
  border-collapse: collapse;
  min-width: 680px;
}

th,
td {
  border: 1px solid #bea680;
  padding: 0.42rem 0.5rem;
  text-align: left;
  vertical-align: top;
}

th {
  background: #ddc59f;
}

.disclaimer-card {
  border-left: 6px solid #93612d;
}

.citation-list {
  margin: 0;
  padding-left: 1.1rem;
  display: grid;
  gap: 0.45rem;
}

.citation-list li {
  display: grid;
  gap: 0.2rem;
}

.citation-list span {
  color: var(--muted);
  font-size: 0.92rem;
}

@media (max-width: 1240px) {
  .top-grid {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }
}

@media (max-width: 980px) {
  .top-grid {
    grid-template-columns: 1fr;
  }

  .system-controls-grid,
  .system-controls-grid.custom-enabled {
    grid-template-columns: 1fr;
  }
}

@media (max-width: 620px) {
  .date-picker-row {
    grid-template-columns: 1fr;
  }

  .moon-indicator-wrap {
    grid-template-columns: 1fr;
  }

  .moon-indicator-svg {
    width: 110px;
    height: 110px;
  }
}

@media (prefers-reduced-motion: no-preference) {
  .day-segment-active,
  .month-segment-active,
  .extra-day-badge.active,
  .zodiac-slice-active {
    animation: pulse 2.5s ease-in-out infinite;
  }
}

@keyframes pulse {
  0%,
  100% {
    opacity: 1;
  }
  50% {
    opacity: 0.86;
  }
}
